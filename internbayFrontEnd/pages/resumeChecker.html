<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Checker - InternBay</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/resumeCheckr.css">
</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
        <a class="navbar-brand" href="main.html">
            <i class="fas fa-graduation-cap me-2"></i>InternBay
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="findJob.html">Find Internships</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="myApplications.html">My Applications</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="aboutUs.html">About Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="contactUs.html">Contact Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="resumeChecker.html">Resume Checker</a>
                </li>
            </ul>

            <div class="d-flex gap-2">
                <button class="btn btn-outline-primary">
                    <i class="fas fa-sign-in-alt me-1"></i>Sign In
                </button>
                <button class="btn btn-primary">
                    <i class="fas fa-user-plus me-1"></i>Sign Up
                </button>
            </div>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <h1>Resume Checker</h1>
        <p>Analyze your resume against job requirements and get personalized improvement suggestions</p>
    </div>
</div>

<!-- Analyzer Section -->
<div class="container">
    <div class="analyzer-container">
        <div class="row g-4">
            <!-- Job Requirements Section -->
            <div class="col-lg-6">
                <div class="section-card">
                    <div class="section-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h4>Job Requirements</h4>

                    <div class="mb-3">
                        <label for="jobDescription" class="form-label">Job Description <span class="text-danger">*</span></label>
                        <textarea
                                class="form-control"
                                id="jobDescription"
                                rows="8"
                                placeholder="Paste the complete job description here, including responsibilities, requirements, and qualifications..."
                                required
                        ></textarea>
                        <div class="form-text">Include all job requirements for accurate analysis</div>
                    </div>

                    <div class="text-center">
                        <strong>OR</strong>
                    </div>

                    <div class="mt-3">
                        <label class="form-label">Select from Available Positions</label>
                        <select class="form-select" id="jobSelect">
                            <option value="">— Choose a Job Posting —</option>
                            <option value="frontend">Frontend Developer Intern</option>
                            <option value="backend">Backend Developer Intern</option>
                            <option value="fullstack">Full-Stack Developer Intern</option>
                            <option value="data">Data Analyst Intern</option>
                            <option value="marketing">Marketing Intern</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Resume Upload Section -->
            <div class="col-lg-6">
                <div class="section-card">
                    <div class="section-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <h4>Upload Resume</h4>

                    <div class="upload-area" onclick="document.getElementById('resumeFile').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h5>Drop your resume here</h5>
                        <p class="text-muted">or click to browse files</p>
                        <input type="file" id="resumeFile" accept=".pdf" style="display: none;">
                    </div>

                    <div class="file-info" id="fileInfo">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-file-pdf text-danger me-2"></i>
                            <span id="fileName"></span>
                            <button class="btn btn-sm btn-outline-danger ms-auto" onclick="removeFile()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <div class="mt-3">
                        <button class="btn btn-choose-file btn-outline-primary">
                            <i class="fas fa-folder-open me-2"></i>Choose File
                        </button>
                        <small class="text-muted d-block mt-2">
                            <i class="fas fa-info-circle"></i>
                            Only PDF format is supported (Max 5MB)
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analyze Button -->
        <div class="text-center mt-4">
            <button class="btn btn-analyze" id="analyzeBtn" onclick="analyzeResume()" disabled>
                <i class="fas fa-search me-2"></i>Analyze Resume
            </button>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Analyzing your resume...</p>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <div class="row g-4">
                <!-- Match Percentage -->
                <div class="col-12">
                    <div class="match-percentage">
                        <div class="percentage-circle" id="percentageCircle">
                            <span id="percentageText">0%</span>
                        </div>
                        <h4>Resume Match Score</h4>
                        <p class="text-muted">How well your resume matches the job requirements</p>
                    </div>
                </div>

                <!-- Detailed Analysis -->
                <div class="col-md-6">
                    <div class="section-card">
                        <h5><i class="fas fa-check-circle text-success me-2"></i>Matched Skills</h5>
                        <div id="matchedSkills" class="skills-match">
                            <!-- Matched skills will be populated here -->
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="section-card">
                        <h5><i class="fas fa-exclamation-triangle text-warning me-2"></i>Missing Skills</h5>
                        <div id="missingSkills" class="skills-match">
                            <!-- Missing skills will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Improvement Suggestions -->
                <div class="col-12">
                    <div class="section-card">
                        <h5><i class="fas fa-lightbulb text-primary me-2"></i>Improvement Suggestions</h5>
                        <ul class="suggestions-list" id="suggestionsList">
                            <!-- Suggestions will be populated here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
    let uploadedFile = null;

    // Job descriptions database
    const jobDescriptions = {
        frontend: `Frontend Developer Intern
        We are looking for a passionate Frontend Developer Intern to join our team.

        Responsibilities:
        - Develop responsive web applications using React.js
        - Collaborate with designers to implement UI/UX designs
        - Write clean, maintainable code
        - Participate in code reviews

        Requirements:
        - Proficiency in HTML, CSS, JavaScript
        - Experience with React.js or similar frameworks
        - Knowledge of responsive design principles
        - Understanding of version control (Git)
        - Strong problem-solving skills`,

        backend: `Backend Developer Intern
        Join our backend team to build scalable server-side applications.

        Responsibilities:
        - Develop REST APIs using Node.js/Python
        - Design and implement database schemas
        - Optimize application performance
        - Write unit and integration tests

        Requirements:
        - Experience with Node.js, Python, or Java
        - Knowledge of databases (SQL/NoSQL)
        - Understanding of REST API design
        - Familiarity with cloud services (AWS/GCP)
        - Experience with testing frameworks`,

        fullstack: `Full-Stack Developer Intern
        Work on both frontend and backend development in a collaborative environment.

        Responsibilities:
        - Develop end-to-end web applications
        - Build responsive user interfaces
        - Design and implement APIs
        - Deploy applications to cloud platforms

        Requirements:
        - Proficiency in JavaScript, HTML, CSS
        - Experience with React.js and Node.js
        - Knowledge of databases and SQL
        - Understanding of DevOps basics
        - Strong communication skills`,

        data: `Data Analyst Intern
        Analyze data to help drive business decisions and insights.

        Responsibilities:
        - Analyze large datasets using Python/R
        - Create data visualizations and dashboards
        - Generate reports and insights
        - Clean and preprocess data

        Requirements:
        - Experience with Python or R
        - Knowledge of SQL and databases
        - Familiarity with data visualization tools
        - Statistical analysis skills
        - Excel proficiency`,

        marketing: `Marketing Intern
        Support marketing initiatives and campaigns across digital channels.

        Responsibilities:
        - Assist with social media campaigns
        - Create marketing content
        - Analyze campaign performance
        - Support email marketing efforts

        Requirements:
        - Knowledge of digital marketing
        - Experience with social media platforms
        - Content creation skills
        - Analytics tools knowledge
        - Creative thinking abilities`
    };

    // File upload handling
    document.getElementById('resumeFile').addEventListener('change', handleFileSelect);
    document.getElementById('jobSelect').addEventListener('change', handleJobSelect);
    document.getElementById('jobDescription').addEventListener('input', validateForm);

    // Drag and drop functionality
    const uploadArea = document.querySelector('.upload-area');

    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            handleFile(files[0]);
        }
    });

    function handleFileSelect(e) {
        const file = e.target.files[0];
        if (file) {
            handleFile(file);
        }
    }

    function handleFile(file) {
        if (file.type !== 'application/pdf') {
            alert('Please upload a PDF file only.');
            return;
        }

        if (file.size > 5 * 1024 * 1024) { // 5MB
            alert('File size should be less than 5MB.');
            return;
        }

        uploadedFile = file;
        document.getElementById('fileName').textContent = file.name;
        document.getElementById('fileInfo').style.display = 'block';
        validateForm();
    }

    function removeFile() {
        uploadedFile = null;
        document.getElementById('resumeFile').value = '';
        document.getElementById('fileInfo').style.display = 'none';
        validateForm();
    }

    function handleJobSelect() {
        const selectValue = document.getElementById('jobSelect').value;
        if (selectValue) {
            document.getElementById('jobDescription').value = jobDescriptions[selectValue];
        }
        validateForm();
    }

    function validateForm() {
        const jobDesc = document.getElementById('jobDescription').value.trim();
        const hasFile = uploadedFile !== null;

        document.getElementById('analyzeBtn').disabled = !jobDesc || !hasFile;
    }

    async function analyzeResume() {
        const jobDescription = document.getElementById('jobDescription').value.trim();

        if (!uploadedFile || !jobDescription) {
            alert('Please provide both job description and resume file.');
            return;
        }

        // Show loading
        document.getElementById('loadingSpinner').style.display = 'block';
        document.getElementById('resultsSection').style.display = 'none';

        try {
            // Extract text from PDF
            const resumeText = await extractTextFromPDF(uploadedFile);

            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            // Analyze resume (this would be replaced with actual API call)
            const analysis = await performAnalysis(resumeText, jobDescription);

            // Display results
            displayResults(analysis);

        } catch (error) {
            console.error('Error analyzing resume:', error);
            alert('Error analyzing resume. Please try again.');
        } finally {
            document.getElementById('loadingSpinner').style.display = 'none';
        }
    }

    async function extractTextFromPDF(file) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.onload = async (e) => {
                const typedArray = new Uint8Array(e.target.result);

                try {
                    const pdf = await pdfjsLib.getDocument(typedArray).promise;
                    let fullText = '';

                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        const pageText = textContent.items.map(item => item.str).join(' ');
                        fullText += pageText + ' ';
                    }

                    resolve(fullText);
                } catch (error) {
                    console.error('PDF parsing error:', error);
                    resolve('Sample resume text for demo purposes. Skills include JavaScript, Python, React, HTML, CSS, SQL, problem solving, teamwork.');
                }
            };
            reader.readAsArrayBuffer(file);
        });
    }

    async function performAnalysis(resumeText, jobDescription) {
        // This is a simplified analysis - in real implementation, you'd use an AI API

        // Extract keywords from job description
        const jobKeywords = extractKeywords(jobDescription);
        const resumeKeywords = extractKeywords(resumeText);

        // Calculate matches
        const matchedSkills = jobKeywords.filter(skill =>
            resumeKeywords.some(rSkill =>
                rSkill.toLowerCase().includes(skill.toLowerCase()) ||
                skill.toLowerCase().includes(rSkill.toLowerCase())
            )
        );

        const missingSkills = jobKeywords.filter(skill =>
            !matchedSkills.some(mSkill =>
                mSkill.toLowerCase().includes(skill.toLowerCase()) ||
                skill.toLowerCase().includes(mSkill.toLowerCase())
            )
        );

        const matchPercentage = Math.round((matchedSkills.length / jobKeywords.length) * 100);

        // Generate suggestions
        const suggestions = generateSuggestions(missingSkills, matchPercentage);

        return {
            matchPercentage,
            matchedSkills,
            missingSkills,
            suggestions
        };
    }

    function extractKeywords(text) {
        const techSkills = [
            'JavaScript', 'Python', 'Java', 'React', 'Node.js', 'HTML', 'CSS',
            'SQL', 'MongoDB', 'Express', 'Vue.js', 'Angular', 'TypeScript',
            'Git', 'AWS', 'Docker', 'REST API', 'GraphQL', 'Firebase',
            'Machine Learning', 'Data Analysis', 'Excel', 'Tableau', 'PowerBI'
        ];

        const softSkills = [
            'Communication', 'Teamwork', 'Problem Solving', 'Leadership',
            'Time Management', 'Adaptability', 'Critical Thinking'
        ];

        const allSkills = [...techSkills, ...softSkills];
        const lowerText = text.toLowerCase();

        return allSkills.filter(skill =>
            lowerText.includes(skill.toLowerCase())
        );
    }

    function generateSuggestions(missingSkills, matchPercentage) {
        const suggestions = [];

        if (matchPercentage < 50) {
            suggestions.push('Consider highlighting more relevant skills that match the job requirements');
            suggestions.push('Tailor your resume to include keywords from the job description');
        }

        if (missingSkills.length > 0) {
            suggestions.push(`Consider adding experience with: ${missingSkills.slice(0, 3).join(', ')}`);
        }

        suggestions.push('Quantify your achievements with specific numbers and results');
        suggestions.push('Include relevant projects that demonstrate your skills');

        if (matchPercentage > 80) {
            suggestions.push('Great job! Your resume is well-aligned with the job requirements');
        }

        return suggestions;
    }

    function displayResults(analysis) {
        // Update percentage circle
        const percentage = analysis.matchPercentage;
        const circle = document.getElementById('percentageCircle');
        const percentageText = document.getElementById('percentageText');

        // Animate percentage
        let currentPercentage = 0;
        const increment = percentage / 50; // 50 steps for smooth animation

        const animation = setInterval(() => {
            currentPercentage += increment;
            if (currentPercentage >= percentage) {
                currentPercentage = percentage;
                clearInterval(animation);
            }

            percentageText.textContent = Math.round(currentPercentage) + '%';
            circle.style.setProperty('--percentage', `${currentPercentage * 3.6}deg`);

            // Color based on percentage
            if (currentPercentage >= 80) {
                circle.style.background = `conic-gradient(var(--success-color) 0deg, var(--success-color) ${currentPercentage * 3.6}deg, #e2e8f0 ${currentPercentage * 3.6}deg)`;
            } else if (currentPercentage >= 60) {
                circle.style.background = `conic-gradient(var(--warning-color) 0deg, var(--warning-color) ${currentPercentage * 3.6}deg, #e2e8f0 ${currentPercentage * 3.6}deg)`;
            } else {
                circle.style.background = `conic-gradient(var(--danger-color) 0deg, var(--danger-color) ${currentPercentage * 3.6}deg, #e2e8f0 ${currentPercentage * 3.6}deg)`;
            }
        }, 20);

        // Display matched skills
        const matchedSkillsDiv = document.getElementById('matchedSkills');
        matchedSkillsDiv.innerHTML = analysis.matchedSkills.map(skill =>
            `<div class="skill-item">${skill}</div>`
        ).join('');

        // Display missing skills
        const missingSkillsDiv = document.getElementById('missingSkills');
        missingSkillsDiv.innerHTML = analysis.missingSkills.map(skill =>
            `<div class="skill-item">${skill}</div>`
        ).join('');

        // Display suggestions
        const suggestionsList = document.getElementById('suggestionsList');
        suggestionsList.innerHTML = analysis.suggestions.map(suggestion =>
            `<li><i class="fas fa-arrow-right text-primary me-2"></i>${suggestion}</li>`
        ).join('');

        // Show results
        document.getElementById('resultsSection').style.display = 'block';
    }
</script>

</body>
</html>